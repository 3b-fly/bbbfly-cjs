/**
 * @author Jan Nejedly support@3b-fly.eu
 * @copyright Jan Nejedly
 * @version 2.0.0
 * @license see license in 'LICENSE' file
 */
var bbbfly=bbbfly||{};bbbfly.widget={};bbbfly.widget.registry={};bbbfly.widget.registry._widgetId=function(a){return Object.isObject(a)&&(a=a.WidgetId,"string"===typeof a&&""!==a)?a:null};
bbbfly.widget.registry._registerWidget=function(a){if(!Object.isObject(a))return!1;var b=this.WidgetId(a);if(!b||this._Widgets[b])return!1;this._Widgets[b]=a;a.AddEvent("OnShow",bbbfly.widget.registry._onWidgetShow);a.AddEvent("OnShown",bbbfly.widget.registry._onWidgetShown);a.AddEvent("OnHidden",bbbfly.widget.registry._onWidgetHidden);bbbfly.widget.registry._registerWidgetInGroup(a);return!0};
bbbfly.widget.registry._registerWidgetInGroup=function(a){var b=bbbfly.WidgetRegistry,c=a.WidgetGroup;b&&"string"===typeof c&&("object"!==typeof b._WidgetGroups[c]&&(b._WidgetGroups[c]=[],b._WidgetGroups_Shown[c]=null),b._WidgetGroups[c].push(a))};
bbbfly.widget.registry._unregisterWidgetFromGroup=function(a){var b=bbbfly.WidgetRegistry,c=a.WidgetGroup;if(b&&"string"===typeof c){b=b._WidgetGroups[c];var d=bbbfly.WidgetRegistry._WidgetGroups_Shown;if("object"===typeof b)for(var f in b)if(b[f]===a){b.splice(f,1);break}d[c]===a&&(d[c]=null)}};bbbfly.widget.registry._getWidgets=function(){return this._Widgets};bbbfly.widget.registry._getWidgetById=function(a){return"string"===typeof a&&this._Widgets[a]?this._Widgets[a]:null};
bbbfly.widget.registry._getGroupWidgets=function(a){return"string"===typeof a&&this._WidgetGroups[a]?this._WidgetGroups[a]:null};bbbfly.widget.registry._getGroupShownWidget=function(a){return"string"===typeof a&&this._WidgetGroups_Shown[a]?this._WidgetGroups_Shown[a]:null};bbbfly.widget.registry._callWidget=function(a,b,c){if(Object.isObject(a)&&"string"===typeof b&&("undefined"===typeof c||"object"===typeof c)&&"function"===typeof a[b])return a[b].apply(a,c?c:[])};
bbbfly.widget.registry._callWidgetById=function(a,b,c){var d=this.GetWidgets();if(d[a])return this.CallWidget(d[a],b,c)};bbbfly.widget.registry._callAllWidgets=function(a,b){return"string"!==typeof a||"undefined"!==typeof b&&"object"!==typeof b?null:bbbfly.widget.registry._callWidgets(this.GetWidgets(),a,b)};
bbbfly.widget.registry._callAllGroupWidgets=function(a,b,c){return"string"!==typeof a||"string"!==typeof b||"undefined"!==typeof c&&"object"!==typeof c?null:bbbfly.widget.registry._callWidgets(this.GetGroupWidgets(a),b,c)};bbbfly.widget.registry._callWidgets=function(a,b,c){if(a){var d=[];ngApp.BeginUpdateParams();for(var f in a){var e=a[f];"function"===typeof e[b]&&d.push(e[b].apply(e,c?c:[]))}ngApp.EndUpdateParams();return d}return null};
bbbfly.widget.registry._onWidgetShow=function(a){var b=this.WidgetGroup;if("string"===typeof b&&(b=bbbfly.WidgetRegistry.GetGroupWidgets(b)))for(var c in b){var d=b[c];if(d!==this&&d.IsShown()&&(a?!d.CanForceHide():!d.CanHide()))return!1}return!0};
bbbfly.widget.registry._onWidgetShown=function(a){var b=bbbfly.WidgetRegistry;b.CallAllWidgets("OnWidgetShown",[this]);var c=this.WidgetGroup;if("string"===typeof c){var d=b.GetGroupWidgets(c);if(d){for(var f in d){var e=d[f];e!==this&&(a?e.ForceHide():e.Hide())}b._WidgetGroups_Shown[c]=this;b.CallAllWidgets("OnWidgetGroupChanged",[c])}}};
bbbfly.widget.registry._onWidgetHidden=function(a){a=bbbfly.WidgetRegistry;a.CallAllWidgets("OnWidgetHidden",[this]);var b=this.WidgetGroup;"string"===typeof b&&this===a.GetGroupShownWidget(b)&&(a._WidgetGroups_Shown[b]=null,a.CallAllWidgets("OnWidgetGroupChanged",[b]))};bbbfly.widget._setForced=function(a){a?(this._forceShown=(a=this.IsShown())?!0:!1,this._forceHidden=a?!1:!0):this._forceHidden=this._forceShown=!1};bbbfly.widget._canShow=function(){return!this._forceHidden&&this.CanForceShow()};
bbbfly.widget._canHide=function(){return!this._forceShown&&this.CanForceHide()};bbbfly.widget._canForceShow=function(){return this.AllowShow&&!this.IsShown()};bbbfly.widget._canForceHide=function(){return this.AllowHide&&this.IsShown()};bbbfly.widget._show=function(){return this.CanShow()?this._DoShow(!1):!1};bbbfly.widget._hide=function(){return this.CanHide()?this._DoHide(!1):!1};bbbfly.widget._forceShow=function(a){this.CanForceShow()&&(this._DoShow(!0),this._forceShown=!0,this._forceHidden=!1)};
bbbfly.widget._forceHide=function(){this.CanForceHide()&&(this._DoHide(!0),this._forceShown=!1,this._forceHidden=!0)};bbbfly.widget._doShow=function(a){ngApp.BeginUpdateParams();if("function"===typeof this.OnShow&&!this.OnShow(a))return ngApp.EndUpdateParams(),!1;this.SetVisible(!0);"function"===typeof this.OnShown&&this.OnShown(a);ngApp.EndUpdateParams();return!0};
bbbfly.widget._doHide=function(a){ngApp.BeginUpdateParams();if("function"===typeof this.OnHide&&!this.OnHide(a))return ngApp.EndUpdateParams(),!1;this.SetVisible(!1);"function"===typeof this.OnHidden&&this.OnHidden(a);ngApp.EndUpdateParams();return!0};bbbfly.widget._showOrHide=function(){return this.IsShown()?!this.Hide():this.Show()};bbbfly.widget._forceShowOrHide=function(){return this.IsShown()?!this.ForceHide():this.ForceShow()};bbbfly.widget._isShown=function(){return!!this.Visible};
bbbfly.widget._setWidgetGroup=function(a){return"string"===typeof a&&a!==this.WidgetGroup?(bbbfly.widget.registry._unregisterWidgetFromGroup(this),this.WidgetGroup=a,bbbfly.widget.registry._registerWidgetInGroup(this),!0):!1};
bbbfly.WidgetRegistry={_Widgets:{},_WidgetGroups:{},_WidgetGroups_Shown:{},WidgetId:bbbfly.widget.registry._widgetId,RegisterWidget:bbbfly.widget.registry._registerWidget,GetWidgets:bbbfly.widget.registry._getWidgets,GetWidgetById:bbbfly.widget.registry._getWidgetById,GetGroupWidgets:bbbfly.widget.registry._getGroupWidgets,GetGroupShownWidget:bbbfly.widget.registry._getGroupShownWidget,CallWidget:bbbfly.widget.registry._callWidget,CallWidgetById:bbbfly.widget.registry._callWidgetById,CallAllWidgets:bbbfly.widget.registry._callAllWidgets,
CallAllGroupWidgets:bbbfly.widget.registry._callAllGroupWidgets};
bbbfly.Widget=function(a,b,c){ng_MergeDef(a,{ParentReferences:!1,Data:{WidgetId:null,WidgetGroup:null,AllowHide:!0,AllowShow:!0,Visible:!1,_forceHidden:!1,_forceShown:!1},Events:{OnShow:null,OnHide:null,OnShown:null,OnHidden:null},Methods:{_DoShow:bbbfly.widget._doShow,_DoHide:bbbfly.widget._doHide,SetForced:bbbfly.widget._setForced,CanShow:bbbfly.widget._canShow,CanHide:bbbfly.widget._canHide,CanForceShow:bbbfly.widget._canForceShow,CanForceHide:bbbfly.widget._canForceHide,Show:bbbfly.widget._show,
Hide:bbbfly.widget._hide,ShowOrHide:bbbfly.widget._showOrHide,ForceShow:bbbfly.widget._forceShow,ForceHide:bbbfly.widget._forceHide,ForceShowOrHide:bbbfly.widget._forceShowOrHide,IsShown:bbbfly.widget._isShown,SetWidgetGroup:bbbfly.widget._setWidgetGroup}});(a=ngCreateControlAsType(a,"ngPanel",b,c))&&bbbfly.WidgetRegistry.RegisterWidget(a);return a};ngUserControls=ngUserControls||[];ngUserControls.bbbfly_widget={OnInit:function(){ngRegisterControlType("bbbfly.Widget",bbbfly.Widget)}};
